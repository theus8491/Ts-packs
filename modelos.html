<!DOCTYPE html>
<html lang="pt-BR" style="scroll-behavior:smooth">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TS Packs - Modelos</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;800&display=swap" rel="stylesheet">
<style>
  body{font-family:Poppins,sans-serif; background-color: #0a0a0a;}
  
  .card { 
    border-radius:20px; 
    overflow:hidden; 
    background:#121212; 
    border:1px solid #1f1f1f; 
    height:500px; 
    position:relative; 
    transition:.3s; 
    display: flex;
    flex-direction: column;
  }
  
  .card:hover{ 
    transform:translateY(-6px); 
    border-color:#dc2626; 
    box-shadow:0 10px 25px rgba(220,38,38,.25); 
  }

  .foto-modelo { 
    width: 100%; 
    height: 320px; 
    object-fit: cover; 
    object-position: center top; 
  }

  .view-badge {
    position: absolute;
    top: 15px;
    right: 15px;
    background: rgba(0, 0, 0, 0.7);
    backdrop-filter: blur(8px);
    padding: 4px 12px;
    border-radius: 20px;
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 11px;
    color: #fff;
    border: 1px solid rgba(255,255,255,0.1);
    z-index: 10;
  }

  .descricao-corta {
    font-size: 12px;
    color: #a3a3a3;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    line-height: 1.4;
  }

  .btn-whats {
    background-color: #25d366;
    color: white;
    text-align: center;
    padding: 12px;
    font-weight: 800;
    border-radius: 12px;
    margin: 15px;
    margin-top: auto;
    text-transform: uppercase;
    font-size: 13px;
    transition: 0.2s;
  }
  .btn-whats:hover { filter: brightness(1.1); }
</style>
</head>
<body class="bg-neutral-950 text-white">

<header class="fixed w-full z-50 bg-black/60 backdrop-blur border-b border-white/5">
  <div class="max-w-7xl mx-auto px-6 py-5 flex justify-between items-center">
    <h1 class="text-3xl font-extrabold tracking-widest italic">TS<span class="text-red-600">PACKS</span></h1>
    <nav class="flex gap-6 items-center text-xs font-bold uppercase tracking-widest">
      <a href="index.html" class="hover:text-red-600 transition">INÍCIO</a>
      <a href="modelos.html" class="text-red-600">MODELOS</a>
      <a href="cadastro.html" class="bg-white/5 border border-white/10 px-4 py-2 rounded-lg hover:bg-white hover:text-black transition">CADASTRAR</a>
    </nav>
  </div>
</header>

<section class="pt-40 pb-16 text-center px-6">
  <h2 class="text-4xl font-black mb-4 italic uppercase">Nossas <span class="text-red-600">Modelos</span></h2>
  <div class="h-1 w-20 bg-red-600 mx-auto rounded-full mb-4"></div>
  <p class="text-neutral-500 text-sm italic uppercase tracking-widest">Perfis Independentes • Verificados</p>
</section>

<section class="max-w-7xl mx-auto px-6 pb-24">
  <div id="modelosGrid" class="grid sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-8">
      <p class="text-center col-span-full text-neutral-600 animate-pulse uppercase text-[10px] font-bold py-20">Sincronizando modelos em tempo real...</p>
  </div>
</section>

<script>
// CONEXÃO SUPABASE
const _supabase = supabase.createClient('https://ezcdhydjxielfhjqgblk.supabase.co', 'sb_publishable__ACUqgBDxQZIqCzY13LyKQ__IgrksjW');

// LOGICA DE VIEW (MESMA DO INDEX)
async function registrarView(id, viewsAtuais) {
  try {
    await _supabase
      .from('modelos')
      .update({ views: (viewsAtuais || 0) + 1 })
      .eq('id', id);
  } catch (e) { console.error("Erro ao registrar view:", e); }
}

async function carregarModelos(){
  const grid = document.getElementById('modelosGrid');

  try {
    // Busca modelos APROVADAS (Independente de ser VIP ou não nesta página)
    const { data, error } = await _supabase
      .from('modelos')
      .select('*')
      .eq('aprovado', true)
      .order('created_at', { ascending: false });

    if (error) throw error;

    if (data && data.length > 0) {
      grid.innerHTML = data.map(m => {
        const zapLimpo = m.whatsapp ? m.whatsapp.replace(/\D/g, '') : '';
        const v = m.views || 0;
        
        return `
          <div class="card">
            <div class="view-badge">
              <svg width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/>
              </svg>
              <span>${v}</span>
            </div>

            <img src="${m.foto_url}" class="foto-modelo" loading="lazy" onerror="this.src='https://via.placeholder.com/400x600?text=Foto+Indisponivel'">
            
            <div class="p-5 flex-1 flex flex-col">
              <div class="flex justify-between items-start mb-2">
                <h3 class="font-black text-xl uppercase italic text-white">${m.nome}</h3>
                <span class="text-[9px] font-bold bg-white/5 px-2 py-1 rounded text-neutral-400">${m.idade || '18+'} ANOS</span>
              </div>
              
              <p class="descricao-corta mb-4">
                ${m.descricao || 'Clique no botão abaixo para conferir minha tabela e conteúdos.'}
              </p>
              
              <a href="https://wa.me/55${zapLimpo}" 
                 target="_blank" 
                 onclick="registrarView('${m.id}', ${v})"
                 class="btn-whats">
                 WhatsApp
              </a>
            </div>
          </div>
        `;
      }).join('');
    } else {
      grid.innerHTML = `<p class="col-span-full text-center text-neutral-600 uppercase text-xs font-bold py-20">Nenhuma modelo cadastrada no momento.</p>`;
    }

  } catch (err) {
    grid.innerHTML = `<p class="col-span-full text-center text-red-500 uppercase text-xs font-bold">Falha na conexão com o banco.</p>`;
  }
}

carregarModelos();
</script>
</body>
</html>s